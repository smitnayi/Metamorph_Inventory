{% extends "base.html" %}
{% block title %}Utilities - Metamorph Metals{% endblock %}

{% block extra_scripts %}
<script>
    function utilitiesData() {
        return {
            timePeriod: 'Live',
            utilityData: {
                gas: 245,
                electricity: 1847,
                water: 320
            },
            
            updateTimePeriod(period) {
                this.timePeriod = period;
                // Simulate data change based on time period
                if (period === '24h') {
                    this.utilityData = { gas: 230, electricity: 1920, water: 310 };
                } else if (period === '7d') {
                    this.utilityData = { gas: 255, electricity: 1780, water: 335 };
                } else {
                    this.utilityData = { gas: 245, electricity: 1847, water: 320 };
                }
            },
            
            getTrendColor(value) {
                return value >= 0 ? 'text-green-500' : 'text-red-500';
            },
            
            getTrendIcon(value) {
                return value >= 0 ? 'trending_up' : 'trending_down';
            },
            
            formatNumber(num) {
                return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            }
        }
    }
</script>
{% endblock %}

{% block content %}
<div class="fade-in" x-data="utilitiesData()">
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
        <h2 class="text-3xl font-bold tracking-tight text-gray-900 dark:text-white">Utilities Monitoring</h2>
        <div class="flex items-center gap-2">
            <div class="flex items-center gap-1 rounded-lg border border-gray-200/20 dark:border-gray-700/60 bg-white/5 dark:bg-black/10 p-1">
                <button :class="{'bg-primary text-black': timePeriod === 'Live', 'text-gray-600 dark:text-gray-300': timePeriod !== 'Live'}" 
                        @click="updateTimePeriod('Live')"
                        class="px-3 py-1.5 text-sm font-bold rounded-md transition-colors">Live</button>
                <button :class="{'bg-primary text-black': timePeriod === '24h', 'text-gray-600 dark:text-gray-300': timePeriod !== '24h'}" 
                        @click="updateTimePeriod('24h')"
                        class="px-3 py-1.5 text-sm font-bold rounded-md transition-colors">24h</button>
                <button :class="{'bg-primary text-black': timePeriod === '7d', 'text-gray-600 dark:text-gray-300': timePeriod !== '7d'}" 
                        @click="updateTimePeriod('7d')"
                        class="px-3 py-1.5 text-sm font-bold rounded-md transition-colors">7d</button>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 gap-6 lg:grid-cols-2">
        <!-- Gas Consumption -->
        <div class="flex flex-col rounded-xl border border-gray-200/20 dark:border-gray-700/60 bg-white/5 dark:bg-black/10 p-5">
            <div class="flex items-start justify-between">
                <div>
                    <h3 class="font-bold text-gray-900 dark:text-white">Gas Consumption</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400" x-text="timePeriod + ' Monitoring'"></p>
                </div>
                <div class="flex items-center gap-1 text-green-500">
                    <span class="material-symbols-outlined text-sm">trending_up</span>
                    <span class="font-bold">+2%</span>
                </div>
            </div>
            <div class="flex flex-1 items-end gap-6 mt-4">
                <div class="w-1/2">
                    <p class="text-xs text-gray-400 dark:text-gray-500">Current</p>
                    <p class="text-3xl font-bold text-gray-900 dark:text-white" x-text="utilityData.gas + ' mÂ³'"></p>
                </div>
                <div class="flex-1 spark-chart-positive-light dark:spark-chart-positive-dark h-16">
                    <svg fill="none" height="100%" preserveAspectRatio="none" viewBox="0 0 472 100" width="100%" xmlns="http://www.w3.org/2000/svg">
                        <path d="M0 72.6667C18.1538 72.6667 18.1538 14 36.3077 14C54.4615 14 54.4615 27.3333 72.6154 27.3333C90.7692 27.3333 90.7692 62 108.923 62C127.077 62 127.077 22 145.231 22C163.385 22 163.385 67.3333 181.538 67.3333C199.692 67.3333 199.692 40.6667 217.846 40.6667C236 40.6667 236 30 254.154 30C272.308 30 272.308 80.6667 290.462 80.6667C308.615 80.6667 308.615 99.3333 326.769 99.3333C344.923 99.3333 344.923 0.666667 363.077 0.666667C381.231 0.666667 381.231 54 399.385 54C417.538 54 417.538 86 435.692 86C453.846 86 453.846 16.6667 472 16.6667V100H0V72.6667Z" fill="url(#paint0_linear_spark_positive)"></path>
                        <path d="M0 72.6667C18.1538 72.6667 18.1538 14 36.3077 14C54.4615 14 54.4615 27.3333 72.6154 27.3333C90.7692 27.3333 90.7692 62 108.923 62C127.077 62 127.077 22 145.231 22C163.385 22 163.385 67.3333 181.538 67.3333C199.692 67.3333 199.692 40.6667 217.846 40.6667C236 40.6667 236 30 254.154 30C272.308 30 272.308 80.6667 290.462 80.6667C308.615 80.6667 308.615 99.3333 326.769 99.3333C344.923 99.3333 344.923 0.666667 363.077 0.666667C381.231 0.666667 381.231 54 399.385 54C417.538 54 417.538 86 435.692 86C453.846 86 453.846 16.6667 472 16.6667" stroke="var(--stroke-color)" stroke-linecap="round" stroke-width="2"></path>
                        <defs>
                            <linearGradient gradientUnits="userSpaceOnUse" id="paint0_linear_spark_positive" x1="236" x2="236" y1="0.666667" y2="100">
                                <stop stop-color="var(--start-color)"></stop>
                                <stop offset="1" stop-color="var(--end-color)"></stop>
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
            </div>
        </div>

        <!-- Electricity Usage -->
        <div class="flex flex-col rounded-xl border border-gray-200/20 dark:border-gray-700/60 bg-white/5 dark:bg-black/10 p-5">
            <div class="flex items-start justify-between">
                <div>
                    <h3 class="font-bold text-gray-900 dark:text-white">Electricity Usage</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400" x-text="timePeriod + ' Monitoring'"></p>
                </div>
                <div class="flex items-center gap-1 text-red-500">
                    <span class="material-symbols-outlined text-sm">trending_down</span>
                    <span class="font-bold">-1%</span>
                </div>
            </div>
            <div class="flex flex-1 items-end gap-6 mt-4">
                <div class="w-1/2">
                    <p class="text-xs text-gray-400 dark:text-gray-500">Current</p>
                    <p class="text-3xl font-bold text-gray-900 dark:text-white" x-text="formatNumber(utilityData.electricity) + ' kWh'"></p>
                </div>
                <div class="flex-1 spark-chart-negative-light dark:spark-chart-negative-dark h-16">
                    <svg fill="none" height="100%" preserveAspectRatio="none" viewBox="0 0 472 100" width="100%" xmlns="http://www.w3.org/2000/svg">
                        <path d="M0 37.3333C18.1538 37.3333 18.1538 86 36.3077 86C54.4615 86 54.4615 59.3333 72.6154 59.3333C90.7692 59.3333 90.7692 7.33333 108.923 7.33333C127.077 7.33333 127.077 67.3333 145.231 67.3333C163.385 67.3333 163.385 -0.666667 181.538 -0.666667C199.692 -0.666667 199.692 39.3333 217.846 39.3333C236 39.3333 236 55.3333 254.154 55.3333C272.308 55.3333 272.308 -21.3333 290.462 -21.3333C308.615 -21.3333 308.615 -49.3333 326.769 -49.3333C344.923 -49.3333 344.923 99.3333 363.077 99.3333C381.231 99.3333 381.231 19.3333 399.385 19.3333C417.538 19.3333 417.538 -28.6667 435.692 -28.6667C453.846 -28.6667 453.846 75.3333 472 75.3333V100H0V37.3333Z" fill="url(#paint0_linear_spark_negative)"></path>
                        <path d="M0 37.3333C18.1538 37.3333 18.1538 86 36.3077 86C54.4615 86 54.4615 59.3333 72.6154 59.3333C90.7692 59.3333 90.7692 7.33333 108.923 7.33333C127.077 7.33333 127.077 67.3333 145.231 67.3333C163.385 67.3333 163.385 -0.666667 181.538 -0.666667C199.692 -0.666667 199.692 39.3333 217.846 39.3333C236 39.3333 236 55.3333 254.154 55.3333C272.308 55.3333 272.308 -21.3333 290.462 -21.3333C308.615 -21.3333 308.615 -49.3333 326.769 -49.3333C344.923 -49.3333 344.923 99.3333 363.077 99.3333C381.231 99.3333 381.231 19.3333 399.385 19.3333C417.538 19.3333 417.538 -28.6667 435.692 -28.6667C453.846 -28.6667 453.846 75.3333 472 75.3333" stroke="var(--stroke-color)" stroke-linecap="round" stroke-width="2"></path>
                        <defs>
                            <linearGradient gradientUnits="userSpaceOnUse" id="paint0_linear_spark_negative" x1="236" x2="236" y1="-49.3333" y2="100">
                                <stop stop-color="var(--start-color)"></stop>
                                <stop offset="1" stop-color="var(--end-color)"></stop>
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
            </div>
        </div>
    </div>

    <!-- Utility Costs -->
    <div class="mt-8 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
        <div class="flex flex-col rounded-xl border border-gray-200/20 dark:border-gray-700/60 bg-white/5 dark:bg-black/10 p-5">
            <div class="flex justify-between items-start">
                <div>
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Gas Cost</p>
                    <p class="text-2xl font-bold text-gray-900 dark:text-white">$2,847</p>
                </div>
                <span class="material-symbols-outlined text-gray-400 dark:text-gray-500">local_gas_station</span>
            </div>
            <div class="flex items-center gap-2 mt-4">
                <span class="text-red-500 text-sm font-bold">+5%</span>
                <p class="text-xs text-gray-400 dark:text-gray-500">vs last month</p>
            </div>
        </div>

        <div class="flex flex-col rounded-xl border border-gray-200/20 dark:border-gray-700/60 bg-white/5 dark:bg-black/10 p-5">
            <div class="flex justify-between items-start">
                <div>
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Electricity Cost</p>
                    <p class="text-2xl font-bold text-gray-900 dark:text-white">$4,231</p>
                </div>
                <span class="material-symbols-outlined text-gray-400 dark:text-gray-500">bolt</span>
            </div>
            <div class="flex items-center gap-2 mt-4">
                <span class="text-green-500 text-sm font-bold">-2%</span>
                <p class="text-xs text-gray-400 dark:text-gray-500">vs last month</p>
            </div>
        </div>

        <div class="flex flex-col rounded-xl border border-gray-200/20 dark:border-gray-700/60 bg-white/5 dark:bg-black/10 p-5">
            <div class="flex justify-between items-start">
                <div>
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">Water Cost</p>
                    <p class="text-2xl font-bold text-gray-900 dark:text-white">$847</p>
                </div>
                <span class="material-symbols-outlined text-gray-400 dark:text-gray-500">water_drop</span>
            </div>
            <div class="flex items-center gap-2 mt-4">
                <span class="text-green-500 text-sm font-bold">-1%</span>
                <p class="text-xs text-gray-400 dark:text-gray-500">vs last month</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}